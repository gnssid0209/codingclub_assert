<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê²½ë§ˆê²Œì„</title>
  <style>
    body { 
        font-family: sans-serif; 
        text-align: center; 
        padding: 20px 10px; 
        background: #f9f9f9; 
    }
    .container { 
        display: inline-block; 
        padding: 20px; 
        border: 1px solid #ddd; 
        border-radius: 12px; 
        background: #fff; 
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        max-width: 400px;
        width: 90%;
    }
    h2 { font-size: 20px; margin: 12px 0; }
    p { font-size: 14px; margin: 6px 0; }
    .small { font-size: 12px; color: #666; }

    .bet-input { 
        width: 100px; 
        padding: 6px; 
        font-size: 14px; 
        margin-top: 8px; 
        text-align: center;
    }

    button { 
        padding: 10px 16px; 
        font-size: 16px; 
        margin: 6px 4px; 
        border: none; 
        border-radius: 8px; 
        background-color: #4CAF50; 
        color: white; 
        cursor: pointer; 
    }
    button:disabled { background-color: #ccc; cursor: not-allowed; }

    a { display:block; margin:10px 0; font-size:14px; color:#333; text-decoration:none; }

    @media (max-width: 480px) {
        h2 { font-size: 18px; }
        p, .small { font-size: 12px; }
        .bet-input { width: 80px; font-size: 12px; }
        button { font-size: 14px; padding: 8px 12px; }
        .container { padding: 16px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>ê²½ë§ˆê²Œì„</h2>
    <p>ë§ì„ ì„ íƒí•´ì£¼ì„¸ìš”.</p>

    <h2>ğŸ® {{ user.name }}ë‹˜ í™˜ì˜í•©ë‹ˆë‹¤!</h2>
    <p>í•™ë²ˆ: {{ user.id }}</p>

    <!-- í˜„ì¬ ë³´ìœ  ê¸ˆì•¡ -->
    <p class="small">í˜„ì¬ ë³´ìœ  ê¸ˆì•¡: <strong id="current-money">{{ money }}</strong>G</p>

    <a href="{{ url_for('logout') }}">ë¡œê·¸ì•„ì›ƒ</a>

    {% if not game_running %}
      <p style="color: red; font-weight:bold;">ê´€ë¦¬ìê°€ ì•„ì§ ê²Œì„ì„ ì‹œì‘í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ì‹œì‘í•  ë•Œê¹Œì§€ ëŒ€ê¸°í•´ì£¼ì„¸ìš”.</p>
    {% endif %}

    <!-- ì„ íƒ + ë°°íŒ… í¼: ê²Œì„ì´ ì‹œì‘ë˜ì—ˆì„ ë•Œë§Œ í™œì„±í™” -->
    <form action="{{ url_for('check_answer') }}" method="post" onsubmit="return validateBet()">
      <div>
        <label for="bet">ë°°íŒ…ê¸ˆ (ì •ìˆ˜): </label>
        <input id="bet" name="bet" type="number" min="1" step="1" class="bet-input" required {% if not game_running %}disabled{% endif %}>
        <span class="small"> (ìµœëŒ€: <span id="max-money">{{ money }}</span>G)</span>
      </div>

      <div style="margin-top:16px;">
        <button name="answer" value="A" type="submit" {% if not game_running %}disabled{% endif %}>1ë²ˆë§</button>
        <button name="answer" value="B" type="submit" {% if not game_running %}disabled{% endif %}>2ë²ˆë§</button>
        <button name="answer" value="C" type="submit" {% if not game_running %}disabled{% endif %}>3ë²ˆë§</button>
        <button name="answer" value="D" type="submit" {% if not game_running %}disabled{% endif %}>4ë²ˆë§</button>
      </div>
    </form>

    <p class="small" style="margin-top:10px;">(ê´€ë¦¬ìê°€ ê²Œì„ì„ ì‹œì‘í•˜ë©´ ë°°íŒ…ì´ ì—´ë¦¬ê³ , ê´€ë¦¬ìê°€ ì¢…ë£Œí•˜ë©´ ê²°ê³¼ê°€ ë°œí‘œë©ë‹ˆë‹¤)</p>
  </div>

  <script>
    const currentMoney = parseInt(document.getElementById('current-money').textContent) || 0;
    const betInput = document.getElementById('bet');
    const maxMoneySpan = document.getElementById('max-money');
    if (maxMoneySpan) maxMoneySpan.textContent = currentMoney;

    if (betInput) {
      if (currentMoney <= 0) {
        betInput.value = 0;
        betInput.setAttribute('min', 0);
        betInput.setAttribute('readonly', true);
        betInput.placeholder = "ë³´ìœ ê¸ˆ ë¶€ì¡±";
      } else {
        betInput.setAttribute('max', currentMoney);
        betInput.value = 1;
      }
    }

    function validateBet() {
      const betVal = parseInt(betInput.value);
      if (isNaN(betVal) || betVal <= 0) {
        alert("ë°°íŒ… ê¸ˆì•¡ì€ 1 ì´ìƒì˜ ì •ìˆ˜ì—¬ì•¼ í•©ë‹ˆë‹¤.");
        return false;
      }
      if (betVal > currentMoney) {
        alert("ë°°íŒ… ê¸ˆì•¡ì´ ë³´ìœ ê¸ˆë³´ë‹¤ í½ë‹ˆë‹¤.");
        return false;
      }
      return true;
    }
  </script>
</body>
</html>
