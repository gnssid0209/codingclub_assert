<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>결과 대기</title>
  <style>
    body { 
        font-family: sans-serif; 
        text-align: center; 
        padding: 40px 10px; 
        background: #f9f9f9; 
    }
    .box { 
        display: inline-block; 
        padding: 20px; 
        border: 1px solid #ddd; 
        border-radius: 12px; 
        background: #fff; 
        box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        max-width: 400px;
        width: 90%;
    }
    h2 { font-size: 20px; margin-bottom: 12px; }
    p { font-size: 16px; margin: 8px 0; }
    button { 
        margin-top: 16px; 
        padding: 12px 20px; 
        font-size: 16px; 
        border: none; 
        border-radius: 8px; 
        background-color: #4CAF50; 
        color: white; 
        cursor: pointer; 
        width: 100%;
    }
    button:hover { background-color: #45a049; }

    /* 모바일 최적화 */
    @media (max-width: 480px) {
        h2 { font-size: 18px; }
        p { font-size: 14px; }
        .box { padding: 16px; }
        button { font-size: 14px; padding: 10px; }
    }
  </style>
</head>
<body>
  <div class="box">
    <h2>결과를 기다리는 중입니다</h2>
    <p>관리자가 게임을 종료하면 결과가 자동으로 표시됩니다.</p>
    <p id="status">대기 중...</p>
    <p id="money"></p>
    <button onclick="location.href='{{ url_for('play') }}'">베팅 취소 / 돌아가기</button>
  </div>

  <script>
    async function poll() {
      try {
        const res = await fetch("{{ url_for('bet_status') }}");
        const j = await res.json();
        if (j.resolved) {
          document.getElementById('status').textContent = j.message;
          document.getElementById('money').textContent = `현재 잔액: ${j.money}G`;
          // 결과 확인 후 자동 이동 원하면 아래 주석 해제
          // window.location.href = "{{ url_for('result') }}";
          return;
        } else {
          setTimeout(poll, 2000);
        }
      } catch (err) {
        console.error(err);
        setTimeout(poll, 3000);
      }
    }
    poll();
  </script>
</body>
</html>
