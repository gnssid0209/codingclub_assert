<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ê´€ë¦¬ì í˜ì´ì§€</title>
  <style>
    body { font-family: sans-serif; margin: 40px; }
    input, select { margin: 5px; padding: 5px; }
    .section { border: 1px solid #ddd; padding: 12px; margin-bottom: 16px; border-radius: 8px;}
    .status { font-weight: bold; }
    .green { color: green; }
    .red { color: red; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ddd; padding: 6px; text-align: center; }
  </style>
</head>
<body>
  <h2>ğŸ‘©â€ğŸ’» ê´€ë¦¬ì í˜ì´ì§€</h2>

  <div class="section">
    <h3>ê²Œì„ ìƒíƒœ</h3>
    <p>í˜„ì¬ ê²Œì„:
      {% if game.running %}
        <span class="status green">ì§„í–‰ì¤‘(ë² íŒ… í—ˆìš©)</span>
      {% else %}
        <span class="status red">ëŒ€ê¸°(ë² íŒ… ë¶ˆê°€)</span>
      {% endif %}
    </p>
    <p>ì„¤ì •ëœ ì •ë‹µ: <strong>{{ game.answer if game.answer else "ì„¤ì • ì•ˆë¨" }}</strong></p>

    <form method="POST" style="display:inline;">
      <input type="hidden" name="action" value="start">
      <button type="submit">ê²Œì„ ì‹œì‘ (ë² íŒ… í—ˆìš©)</button>
    </form>

    <form method="POST" style="display:inline;">
      <input type="hidden" name="action" value="stop">
      <button type="submit">ê²Œì„ ì¢…ë£Œ ë° ì •ì‚°</button>
    </form>

    <form method="POST" style="display:inline; margin-left:12px;">
      <input type="hidden" name="action" value="set_answer">
      <select name="answer" required>
        <option value="">ì •ë‹µ ì„ íƒ</option>
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="C">C</option>
        <option value="D">D</option>
      </select>
      <button type="submit">ì •ë‹µ ì„¤ì •</button>
    </form>
  </div>

  <div class="section">
    <h3>ëŒ€ê¸°ì¤‘ì¸ ë°°íŒ…ë“¤ (í˜„ì¬ ì ‘ìˆ˜)</h3>
    {% set bets = game.get('bets', []) %}
    {% if bets %}
      <table>
        <tr><th>í•™ë²ˆ</th><th>ì´ë¦„</th><th>ì„ íƒ</th><th>ë°°íŒ…ê¸ˆ</th><th>ì‹œê°„</th></tr>
        {% for b in bets %}
          <tr>
            <td>{{ b.student_id }}</td>
            <td>{{ b.name }}</td>
            <td>{{ b.choice }}</td>
            <td>{{ b.bet }}G</td>
            <td>{{ b.time }}</td>
          </tr>
        {% endfor %}
      </table>
    {% else %}
      <p>ì ‘ìˆ˜ëœ ë°°íŒ…ì´ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endif %}
  </div>

  <div class="section">
    <h3>ìµœê·¼ ì •ì‚° ê²°ê³¼</h3>
    {% set results = game.get('results', {}) %}
    {% if results %}
      <table>
        <tr><th>í•™ë²ˆ</th><th>ê²°ê³¼ ë©”ì‹œì§€</th></tr>
        {% for sid, msg in results.items() %}
          <tr><td>{{ sid }}</td><td>{{ msg }}</td></tr>
        {% endfor %}
      </table>
    {% else %}
      <p>ì •ì‚°ëœ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
    {% endif %}
  </div>

  <div class="section">
    <h3>í•™ìƒ ë“±ë¡</h3>
    <form method="POST">
      <input type="hidden" name="action" value="register">
      <input name="student_id" placeholder="í•™ë²ˆ" required>
      <input name="name" placeholder="ì´ë¦„" required>
      <input name="password" placeholder="ë¹„ë°€ë²ˆí˜¸" type="password" required>
      <button type="submit">í•™ìƒ ë“±ë¡</button>
    </form>
  </div>

  <div class="section">
    <h3>ë“±ë¡ëœ í•™ìƒ ëª©ë¡</h3>
    <ul>
      {% for id, info in users.items() %}
        <li>{{ id }} - {{ info.name }}</li>
      {% endfor %}
    </ul>
  </div>

  {% with messages = get_flashed_messages() %}
  {% if messages %}
    <p style="color: green;">{{ messages[0] }}</p>
  {% endif %}
  {% endwith %}

  <button onclick="window.location.href='/'">í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
</body>
</html>